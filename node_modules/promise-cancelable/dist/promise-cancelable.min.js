!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.Cancelable=e.Cancelable||{})}(this,function(e){"use strict";function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function t(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function r(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}var o=function(){function e(e,n){for(var t=0;n.length>t;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),i="@@Cancelable",l=function(e){function o(){n(this,o);var e=t(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,"Cancelable was canceled"));return e.name="CancelationError",e}return r(o,e),o}(Error),a=function(){function e(t){var r=this;if(n(this,e),this.canceled=!1,this.children=null,this.onCancel=null,this.parent=null,"function"!=typeof t)throw new TypeError("Cancelable resolver undefined is not a function");Object.defineProperty(this,i,{value:!0,writable:!1,readable:!0}),this.promise=new Promise(function(e,n){r._reject=n,new Promise(function(e,n){t(function(n){e(n)},function(e){n(e)},function(e){r.onCancel=e})}).then(function(n){e(n)}).catch(function(e){n(e)})})}return o(e,[{key:"cancel",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=this;if(!t.isCanceled())for(;t;){var r=t;if(t.children){var o=!0,i=!1,a=void 0;try{for(var c,u=t.children[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var f=c.value;e.isCancelable(f)&&(f.cancel(),f=null)}}catch(e){i=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(i)throw a}}t.children=null}t.setCanceled(),t.onCancel&&"function"==typeof t.onCancel&&t.onCancel(n),t.parent||t._reject(new l),t=r.parent,r=null}}},{key:"catch",value:function(){var n,t=e.resolve((n=this.promise).catch.apply(n,arguments));return t.parent=this,t}},{key:"isCanceled",value:function(){return this.canceled}},{key:"setCanceled",value:function(){this.canceled=!0}},{key:"then",value:function(){var n,t=e.resolve((n=this.promise).then.apply(n,arguments));return t.parent=this,t}}],[{key:"all",value:function(n){var t=e.resolve(Promise.all(n)),r=!0,o=!1,i=void 0;try{for(var l,a=n[Symbol.iterator]();!(r=(l=a.next()).done);r=!0){var c=l.value;e.isCancelable(c)&&(t.children?t.children.push(c):t.children=[c])}}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return t}},{key:"isCancelable",value:function(e){return!(!e||!e[i])}},{key:"race",value:function(n){var t=e.resolve(Promise.race(n)),r=!0,o=!1,i=void 0;try{for(var l,a=n[Symbol.iterator]();!(r=(l=a.next()).done);r=!0){var c=l.value;e.isCancelable(c)&&(t.children?t.children.push(c):t.children=[c])}}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return t}},{key:"resolve",value:function(n){return e.isCancelable(n)?n:new e(function(e){e(n)})}},{key:"reject",value:function(n){return e.resolve(Promise.reject(n))}}]),e}();e.CancelationError=l,e.default=a,Object.defineProperty(e,"__esModule",{value:!0})});
